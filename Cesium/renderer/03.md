# Cesium é«˜æ€§èƒ½æ‰©å±•ä¹‹DrawCommandï¼ˆä¸‰ï¼‰ï¼šæ˜¾éšå’Œç‚¹é€‰
 
`DrawCommand` æ˜¯ Cesium æ¸²æŸ“å™¨çš„æ ¸å¿ƒç±»ï¼Œå¸¸ç”¨çš„æ¥å£ `Entity`ã€`Primitive`ã€`Cesium3DTileSet`ï¼Œä»¥åŠåœ°å½¢å’Œå½±åƒçš„æ¸²æŸ“ç­‰ç­‰ï¼Œåº•å±‚éƒ½æ˜¯ä¸€ä¸ªä¸ª `DrawCommand` å®Œæˆçš„ã€‚åœ¨è¿›è¡Œæ‰©å±•å¼€å‘ã€è§†è§‰ç‰¹æ•ˆæå‡ã€æ€§èƒ½ä¼˜åŒ–ã€æ¸²æŸ“åˆ°çº¹ç†ï¼ˆRTTï¼‰ï¼Œç”šè‡³åŸºäº Cesium å°è£…è‡ªå·±çš„å¼€å‘æ¡†æ¶ï¼Œå®šä¹‰ç‹¬å®¶æ•°æ®æ ¼å¼ç­‰ç­‰ï¼Œéƒ½éœ€è¦å¼€å‘äººå‘˜å¯¹ `DrawCommand` ç†Ÿç»ƒæŒæ¡ã€‚è€Œè¿™éƒ¨åˆ†æ¥å£ï¼ŒCesium å®˜æ–¹æ–‡æ¡£æ²¡æœ‰å…¬å¼€ï¼Œç½‘ä¸Šçš„ç›¸å…³èµ„æ–™ä¹Ÿæ¯”è¾ƒå°‘ï¼Œå­¦ä¹ èµ·æ¥æ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨å‡ æœŸæ–‡ç« ï¼Œç”±æµ…å…¥æ·±ï¼Œå®ç”¨ä¸ºä¸»ï¼ŒåŠ›æ±‚å…¨é¢åœ°ä»‹ç» `DrawCommand` åŠç›¸å…³ç±»çš„è¿ç”¨ã€‚

ç¬¬ä¸€æ¬¡è¢«å…³æ³¨æˆ‘ä»¬çš„å°ä¼™ä¼´å‚¬æ›´ï¼Œè¿˜æ˜¯æŒºå¼€å¿ƒçš„ğŸ˜‚ï¼Œå…¬å¸äº‹åŠ¡ç•¥å¿™ï¼Œåªæœ‰æ·±å¤œç å­—æ¥èµ¶ç¨¿äº†ï½é‚£ä¹ˆæœ¬ç¯‡æˆ‘ä»¬å°±æŒ‰ç…§è®¡åˆ’å¾€ä¸‹å†™ï¼Œä»‹ç»`è‡ªå®šä¹‰Primitive`çš„æ˜¾éšæ§åˆ¶ï¼Œä»¥åŠå¦‚ä½•æ”¯æŒ`scene.pick`ï¼Œå®ç°è¦ç´ æ‹¾å–æŸ¥è¯¢ã€‚

![drawCommand3](./drawCommand3.png)

### 1ã€æ˜¾éšæ§åˆ¶
ä»å‰é¢ä¸¤ç¯‡çš„ä»£ç çœ‹ï¼Œæ˜¾éšæ§åˆ¶æ˜¯éå¸¸ç®€å•çš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨`update`æ–¹æ³•çš„å¼€å¤´åŠ å…¥æ˜¾éšåˆ¤æ–­ï¼Œå¦‚æœéšè—åˆ™ç›´æ¥é€€å‡ºï¼Œå¦åˆ™ç»§ç»­ã€‚
```JavaScript
//...
update(frameState) {
    if (!this.show) return;
    //...
}
//...
```

è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å°†å¤šä¸ªè¦ç´ çš„å‡ ä½•ä½“åˆå¹¶æˆä¸€ä¸ªå‡ ä½•ä½“ï¼Œä»¥è¾¾åˆ°å‡å°‘ç»˜å›¾æ‰¹æ¬¡ï¼ˆ`DrawCommand`çš„æ•°é‡ï¼‰æå‡æ€§èƒ½çš„ç›®çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¸Šè¿°æ–¹æ³•å°†ä¼šåŒæ—¶æ˜¾ç¤ºæˆ–è€…éšè—è¿™äº›è¦ç´ ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•æ§åˆ¶å…¶ä¸­ä»»ä¸€è¦ç´ çš„æ˜¾éšå‘¢ï¼Ÿ

å‚è€ƒ`Cesium`çš„å…¶ä»–`Primitive`ç±»ï¼Œä¼šå‘ç°ä»–ä»¬ä¸ºæ¯ä¸€ä¸ªé¡¶ç‚¹åˆ›å»ºäº†ä¸€ä¸ª`batchId`æˆ–è€…`a_batchId`å±æ€§ï¼Œè¿™ä¸ªå±æ€§éå¸¸é‡è¦ï¼Œé™¤äº†å¯ä»¥ç”¨äºæ§åˆ¶æ˜¾éšå¤–ï¼Œåœ¨`3D Tiles`æ ·å¼å¼•æ“ã€è¦ç´ æ‹¾å–æŸ¥è¯¢ï¼ˆ`pick`ï¼‰ç­‰éƒ½èµ·åˆ°å…³é”®ä½œç”¨ã€‚

è¿™é‡Œç®€å•ä»‹ç»åŸºäº`batchId`çš„æ˜¾éšæ§åˆ¶å®ç°æ€è·¯ï¼š
* ä¸ºæ¯ä¸€ä¸ªè¦ç´ åˆ›å»º`batchId`ï¼Œä»0å¼€å§‹ç¼–å·ï¼›
* ä¸ºè¦ç´ å‡ ä½•ä½“åˆ›å»º`batchId`é¡¶ç‚¹å±æ€§ï¼Œå¹¶å°†`batchId`å€¼é€ä¸ªå†™å…¥é¡¶ç‚¹å±æ€§æ•°ç»„ï¼›
* åˆå¹¶æ‰€æœ‰è¦ç´ å‡ ä½•ä½“ï¼›
* åˆ›å»ºä¸€ä¸ªäºŒç»´æ•°ç»„ç±»å‹çš„çº¹ç†è´´å›¾ï¼Œå®½åº¦ç­‰äºè¦ç´ æ•°é‡ï¼Œé«˜åº¦ä¸º1ï¼Œç”¨`0`å’Œ`1`è¡¨ç¤ºè¦ç´ éšè—æˆ–è€…æ˜¾ç¤ºï¼Œå†™å…¥çº¹ç†æ•°æ®ï¼›
* åœ¨`shader`ä¸­æ ¹æ®`batchId`å¹¶è®¡ç®—uvï¼Œä»æ˜¾éšçº¹ç†è·å–è¦ç´ çš„æ˜¾éšæ ‡è®°ï¼Œå¦‚æœå°äº`1`åˆ™`discard`ï¼›
* å½“æŸä¸ªè¦ç´ æ˜¾éšå‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ›´æ–°æ˜¾éšçº¹ç†ã€‚

ç›®å‰æˆ‘ä»¬å…ˆä¸è¦æƒ³é‚£ä¹ˆå¤æ‚ï¼Œç­‰æŒæ¡äº†æ›´å¤šæŠ€èƒ½ï¼Œéœ€è¦è®¾è®¡è¿™ä¹ˆå¤æ‚çš„`è‡ªå®šä¹‰Primitve`çš„æ—¶å€™ï¼Œè‡ªç„¶èƒ½ç†è§£å¹¶å‚è€ƒ`Cesium`çš„ä»£ç æ¥å®ç°è¿™ä¸€æ˜¾éšæ§åˆ¶æ–¹æ³•ã€‚

### 2ã€æ”¯æŒpickå®ç°ç‚¹é€‰
è¦ç´ æ‹¾å–æŸ¥è¯¢ï¼ˆ`Pick`ï¼‰ï¼Œæ˜¯3Däº¤äº’çš„é‡è¦åŸºç¡€ï¼Œæƒ³è±¡ä¸€ä¸‹ä¸€ä¸ª3Dåº”ç”¨ï¼Œæ‰€æœ‰å›¾å½¢è¦ç´ æ€ä¹ˆç‚¹å‡»éƒ½æ²¡æœ‰ååº”ï¼Œé‚£å®ƒè·Ÿä¸€ä¸ªè§†é¢‘æ’­æ”¾å™¨å°±æ²¡æœ‰ä»€ä¹ˆä¸¤æ ·äº†ï½

`Cesium`æä¾›äº†ç»Ÿä¸€çš„è¦ç´ æ‹¾å–æŸ¥è¯¢æœºåˆ¶ï¼Œæ‹¾å–APIå°è£…åœ¨`Cesium.Scene`ä¸­ï¼Œå‰é¢æˆ‘ä»¬ä»‹ç»`3Dæè¾¹`ç­‰åæœŸå¤„ç†æ—¶å°±æ›¾ä½¿ç”¨è¿‡ï¼Œéå¸¸ç®€å•ã€‚
```JavaScript
 viewer.screenSpaceEventHandler.setInputAction(e => {
    var picked = viewer.scene.pick(e.position)
    if(picked){
        //...
    }
 })
```

é‚£ä¹ˆå¦‚æœè®©æˆ‘ä»¬çš„`è‡ªå®šä¹‰Primitive`èƒ½å¤Ÿè¢«`scene.pick`ç‚¹å‡»æ‹¾å–åˆ°å‘¢ï¼Ÿ

#### 2.1ã€contextåˆ›å»ºpickId
```JavaScript
/**
 * @param {Cesium.Context} context 
 */
createCommand(context) {
    /**
     * @type {Cesium.PickId}
     */
    var pickId = this.pickId;
    if (!pickId) {
        pickId = context.createPickId({
            primitive: this,
            description: 'è¦ç´ æè¿°å†…å®¹',
            //[key:string]:any
        });
        this.pickId = pickId
    }

    //
    var strPickId = 'czm_pickColor';
    var czm_pickColor = pickId.color;
    

    //...
}
```

#### 2.2ã€shaderå£°æ˜pickIdå˜é‡
è¿™é‡Œå¯ä»¥`pickId`å˜é‡ç±»å‹æœ‰ä¸¤ç§ï¼š`uniform`å’Œ`varying`ã€‚
* `uinform`ï¼šå¦‚æœ`DrawCommand`ç»˜åˆ¶çš„æ˜¯å•ä¸€è¦ç´ ï¼Œæ‰€ç»˜åˆ¶çš„å†…å®¹å°±æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œåˆ™ä½¿ç”¨`uniform`ï¼Œæ‰€æœ‰é¡¶ç‚¹çš„pickIdé¢œè‰²æ˜¯ä¸€æ ·çš„ï¼Œé€šè¿‡`uniformMap`æ¥ä¼ é€’ï¼›
* `varying`ï¼šå¦‚æœç»˜åˆ¶çš„æ˜¯å¤šä¸ªè¦ç´ ï¼Œç»˜åˆ¶å†…å®¹å¯èƒ½åˆ†ä¸ºå¤šä¸ªéƒ¨ä»¶ï¼Œåªæ˜¯åˆå¹¶ä¸ºä¸€ä¸ªæ‰¹æ¬¡æ¥æ¸²æŸ“ï¼Œå¯èƒ½æ¯ä¸ªéƒ¨ä»¶éœ€è¦èƒ½å¤Ÿè¢«å•ç‹¬ç‚¹å‡»æ‹¾å–ï¼Œåˆ™ä½¿ç”¨`varying`ï¼Œéœ€è¦å°†æ¯ä¸€ä¸ªéƒ¨ä»¶è¦ç´ çš„`pickId`é¢œè‰²å†™å…¥å¯¹åº”çš„å‡ ä½•é¡¶ç‚¹å±æ€§ï¼Œé¡¶ç‚¹ç€è‰²å™¨æ¥æ”¶é¢œè‰²å€¼ï¼Œå¹¶é€šè¿‡`varying`ä¼ é€’åˆ°åè¿œç€è‰²å™¨ã€‚

##### 2.2.1ã€uniformç±»pickId
```JavaScript
var fs = `
uniform vec3 color; 
//
uniform vec4 ${strPickId}; 
void main(){
    gl_FragColor=vec4( color , 1. );
}
`;
var shaderProgram = Cesium.ShaderProgram.fromCache({
    context: context,
    vertexShaderSource: vs,
    fragmentShaderSource: fs,
    attributeLocations: attributeLocations
})
```

##### 2.2.2ã€ varyingç±»pickId

```JavaScript
var vs = `
attribute vec3 position;
//å£°æ˜pickColorå±æ€§ï¼Œæ¥æ”¶é¡¶ç‚¹pickIdé¢œè‰²
attribute vec4 pickColor;
//
varying vec4 ${strPickId}; 
void main(){
    ${strPickId}=pickColor; 
    gl_Position = czm_projection  * czm_modelView * vec4( position , 1. );
}
`;
var fs = `
uniform vec3 color; 
//
varying vec4 ${strPickId}; 
void main(){
    gl_FragColor=vec4( color , 1. );
}
`;
var shaderProgram = Cesium.ShaderProgram.fromCache({
    context: context,
    vertexShaderSource: vs,
    fragmentShaderSource: fs,
    attributeLocations: attributeLocations
})
```

##### 2.2.3ã€Cesiumå¯¹DrawCommandçš„åç»­åŠ å·¥
å¤§å®¶å¯èƒ½å¾ˆå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆ`pickId`å˜é‡ï¼Œåªæ˜¯å£°æ˜ï¼Œå´æ²¡æœ‰è§åˆ°å…·ä½“çš„ä½¿ç”¨ï¼Œæ€ä¹ˆèƒ½å®ç°ç‚¹å‡»æ‹¾å–å‘¢ï¼Ÿ

è¿™ä¸ªé—®é¢˜ï¼Œå¤§å®¶ä¸å¦¨åœ¨ç»˜åˆ¶å‡ºç»“æœåï¼ˆå»¶è¿Ÿä¸€æ®µæ—¶é—´ï¼‰æ‰“å°å‡º`DrawCommand`å¯¹è±¡çœ‹çœ‹ï¼š
![derivedCommands](./derivedCommands.png)

æˆ‘ä»¬æ¥ç€å±•å¼€çœ‹çœ‹`pickCommand._shaderProgram._vertexShaderText`ï¼š
```glsl
#ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
#else
    precision mediump float;
    #define highp mediump
#endif

#define OES_texture_float_linear
#define OES_texture_float

#line 0
#line 0

uniform vec3 color; 
uniform vec4 czm_pickColor; 
void czm_non_pick_main(){
    gl_FragColor=vec4( color , 1. );
}
        
#line 0
void main() 
{ 
    czm_non_pick_main(); 
    if (gl_FragColor.a == 0.0) { 
        discard; 
    } 
    gl_FragColor = czm_pickColor; 
}
```

`Cesium`ä¸º`pick`æ“ä½œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„`DrawCommand`å‰¯æœ¬`pickCommand`ï¼Œå¹¶ä¸”åŸºäºæˆ‘ä»¬çš„`shader`è¿›è¡ŒåŠ å·¥å¤„ç†ï¼Œåœ¨æ–°çš„`mainå‡½æ•°`ä½¿ç”¨äº†æˆ‘ä»¬å£°æ˜çš„`pickId`å˜é‡ã€‚

åŒæ—¶å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œä¸æ­¢å¤šäº†ä¸€ä¸ª`pickCommand`ï¼Œè¿˜å¢åŠ äº†å¥½å‡ ä¸ªå…¶ä»–`DrawCommand`å‰¯æœ¬ï¼Œè¯´æ˜æˆ‘ä»¬åˆ›å»ºå¥½çš„`DrawCommand`å¹¶æ²¡æœ‰ç›´æ¥è¿›å…¥æ¸²æŸ“é˜¶æ®µï¼Œè€Œæ˜¯è¦ç»è¿‡`Cesium`æ¸²æŸ“å™¨è¿›è¡ŒåŠ å·¥å¤„ç†ï¼Œæ‰æœ€ç»ˆäº¤ä»˜æ‰§è¡Œæ¸²æŸ“ã€‚

æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¼€å¯äº†é˜´å½±é‚£ä¹ˆä¼šä¸ä¼šåˆå¢åŠ ä¸€ä¸ªå‰¯æœ¬å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜æˆ‘ä»¬ç•™åˆ°ä¸‹ä¸€ç¯‡æ¥æ¢è®¨ã€‚

#### 2.3ã€ä¼ é€’pickIdé¢œè‰²
ä¸`2.2`èŠ‚ç›¸å¯¹åº”ï¼Œå¦‚æœ`pickId`å˜é‡ä¸º`uniform`ç±»ï¼Œåˆ™é€šè¿‡`unformMap`ä¼ é€’å…¶é¢œè‰²ï¼Œå¦‚æœä¸º`varying`åˆ™éœ€è¦ä¿®æ”¹å‡ ä½•ä½“ï¼Œå¢åŠ `pickId`é¢œè‰²ç›¸å…³çš„é¡¶ç‚¹å±æ€§ã€‚
##### 2.3.1ã€uniformMapä¼ é€’
```JavaScript
 var uniformMap = {
    color() {
        return Cesium.Color.GRAY
    },
    //å¦‚æœpickIdä¸ºuniformç±»ï¼Œåˆ™è¿™é‡Œå¿…é¡»ä¼ é€’pickIdé¢œè‰²ï¼›ä¸ºvaryingåˆ™å¯ä»¥å»æ‰ï¼Œä¸å»æ‰ä¹Ÿä¸å½±å“ä½¿ç”¨
    [strPickId]() {
        return czm_pickColor;
    }
}
```

##### 2.3.2ã€é¡¶ç‚¹å±æ€§ä¼ é€’
è¿™ç§æƒ…å†µä¸‹ï¼Œ`2.1`åˆ›å»ºçš„`pickId`å°±ä¸å¤Ÿç”¨äº†ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªè¦ç´ çš„å‡ ä½•ä½“åˆ›å»ºä¸€ä¸ª`pickId`ã€‚æˆ‘ä»¬å®šä¸€ä¸ªæ–¹æ³•ï¼Œæ¥å¤„ç†æ¯ä¸€ä¸ªè¦ç´ çš„å‡ ä½•ä½“ã€‚
```JavaScript
/**
 * @param {object} feature 
 * @param {Cesium.Geometry} geometry
 * @param {Cesium.Context} context 
 */
setPickId(feature, geometry, context) {
    //åˆ›å»ºpickId
    var pickId = context.createPickId({
        feature: feature,
        primitive: this
    })
    //ä¿å­˜pickIdï¼Œç”¨äºåæœŸå¤„ç†ã€é‡Šæ”¾ç­‰
    this.pickIds.push(pickId);

    //å¢åŠ å‡ ä½•é¡¶ç‚¹å±æ€§pickColorï¼Œè¿™é‡Œå±æ€§åç§°å’Œé¡¶ç‚¹ç€è‰²å™¨é‡Œé¢çš„å¯¹åº”attributeå˜é‡åç§°ä¸€è‡´

    var ptCount = geometry.attributes.position.values.length / 3
    var pickColors = [], { red, green, blue, alpha } = pickId.color;
    for (let i = 0; i < ptCount; i++) {
        pickColors.push(red, green, blue, alpha)
    }
    pickColors = new Float32Array(pickColors);

    geometry.attributes.pickColor = new GeometryAttribute({
        componentDatatype: ComponentDatatype.FLOAT,
        componentsPerAttribute: 4,
        normalize: false,
        values: pickColors
    })
}
```

#### 2.4ã€drawCommandæŒ‡å®špickIdå˜é‡å
```JavaScript
this.drawCommand = new Cesium.DrawCommand({
    modelMatrix: modelMatrix,
    vertexArray: va,
    shaderProgram: shaderProgram,
    uniformMap: uniformMap,
    renderState: renderState,
    pass: Cesium.Pass.OPAQUE,
    //
    pickId: strPickId
})
```

#### 2.5ã€é‡Šæ”¾pickId
éœ€è¦æ³¨æ„ï¼Œå½“æˆ‘ä»¬ä¸éœ€è¦`pickId`æˆ–è€…`drawCommand`é‡Šæ”¾æˆ–è€…æ•´ä¸ª`Primitive`é‡Šæ”¾æ—¶ï¼Œä¸€å®šè¦`é‡Šæ”¾pickId`ï¼Œå¦åˆ™å°†ä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šå°†primitiveå¯¹è±¡ç»‘å®šåˆ°pickIdï¼Œè¿™ä¸ªpickIdä¸é‡Šæ”¾çš„è¯ï¼Œä¼šä¸€ç›´ä¿å­˜åœ¨`context`çš„ç¼“å­˜é‡Œï¼Œç›´åˆ°æ•´ä¸ªç¨‹åºæ¶ˆäº¡ã€‚

ä¸‹é¢æ˜¯å®Œæ•´çš„drawCommanddé‡Šæ”¾æ–¹æ³•ï¼ŒåŒ…å«äº†pickIdçš„é‡Šæ”¾ã€‚
```JavaScript
destroy(){
    var drawCommand = this.drawCommand;
    if (drawCommand) {
        var va = drawCommand.vertexArray, sp = drawCommand.shaderProgram;
        if (!va.isDestroyed()) va.destroy();
        if (!sp.isDestroyed || !sp.isDestroyed()) {
            sp.destroy();
        }
        drawCommand.isDestroyed = function returnTrue() {
            return true
        };
        drawCommand.uniformMap = undefined;
        drawCommand.renderState = Cesium.RenderState.removeFromCache(drawCommand.renderState)
        this.drawCommand=null
    }
    //å•ä¸ªè¦ç´ çš„pickId
    if(this.pickId){
        this.pickId.destroy()
        this.pickId=null
    }
    //å¤šä¸ªè¦ç´ çš„pickId
    if(this.pickIds){
        this.pickIds.forEach(pickId=>{
            pickId.destroy()
        })
        this.pickIds.length=0;
    }
}
```
### 3ã€ç‚¹é€‰ç¤ºä¾‹åŠæ•ˆæœè§†é¢‘
```JavaScript
var origin = Cesium.Cartesian3.fromDegrees(106, 26, 250000)
var modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(origin)
var primitive = new MyPrimitive(modelMatrix);
viewer.scene.primitives.add(primitive)

//æ‹¾å–ç»“æœé«˜äº®
var edgedStage = createEdgeStage()
edgedStage.uniforms.useSingleColor = true;
edgedStage.visibleEdgeColor = Cesium.Color.DARKORANGE
viewer.postProcessStages.add(edgedStage)

//æµ‹è¯•pick
viewer.screenSpaceEventHandler.setInputAction(e => {
    var picked = viewer.scene.pick(e.position)

    viewer.selectedEntity = undefined
    edgedStage.selected = [];

    if (picked && picked.primitive && picked.primitive instanceof MyPrimitive) {
        viewer.selectedEntity = new Cesium.Entity({
            name: "æ‹¾å–ç»“æœ",
            description: picked.description
        })
        edgedStage.selected = [picked.primitive]
    }

}, Cesium.ScreenSpaceEventType.LEFT_CLICK)
```
<p>
    <video style="max-width:100%" id="video" controls="" preload="none" poster="./drawCommand3.png">
        <source id="mp4" src="uniform.mp4" type="video/mp4">
    </video>
</p>


æœ‰æ²¡æœ‰å‘ç°ï¼Œå½“æˆ‘ä»¬åŠ å…¥`pickId`ä¹‹åï¼Œä¸ä½†ç‚¹å‡»æ‹¾å–æŸ¥è¯¢åŠŸèƒ½å®ç°äº†ï¼ŒåŒ…æ‹¬åæœŸå¤„ç†é«˜äº®ä¹Ÿè‡ªç„¶æ”¯æŒäº†ï¼Œè¿™æ˜¯å› ä¸ºCesiumåæœŸå¤„ç†çš„è¦ç´ é€‰æ‹©ä¹Ÿæ˜¯åŸºäº`pickId`å®ç°çš„ã€‚

> æœ¬ç¯‡åˆ°æ­¤ç»“æŸï¼Œå¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œä¸å¦¨ç‚¹èµ+åˆ†äº«ï¼Œè®©æ›´å¤šå°ä¼™ä¼´ä¸€èµ·æ¥äº¤æµå­¦ä¹ å§ï¼
> ä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†ä»‹ç»é˜´å½±ï¼ˆshadowsï¼‰å’Œå®ä¾‹åŒ–ï¼ˆinstancingï¼‰ï¼Œæ•¬è¯·æœŸå¾…ï¼

### æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€ä¸‰ç»´ç½‘æ ¼3Dã€‘ï¼Œç¬¬ä¸€æ—¶é—´è·å–æœ€æ–°æ–‡ç«  ###
![å¾®ä¿¡å…¬ä¼—å·ã€ä¸‰ç»´ç½‘æ ¼3Dã€‘](http://os.mesh-3d.com/articles/å¾®ä¿¡å…¬ä¼—å·ã€ä¸‰ç»´ç½‘æ ¼3Dã€‘.png)